# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Google Sheets

- **–°–æ–≤–º–µ—Å—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø** - –ø–æ—Å—Ç–∞–≤—â–∏–∫ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –º–æ–≥—É—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- **–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π** - –≤–∏–¥–Ω–æ –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏–ª –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** - –º–æ–∂–Ω–æ –æ–±—Å—É–∂–¥–∞—Ç—å —Å–ø–æ—Ä–Ω—ã–µ —Å–ª—É—á–∞–∏
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- **API –¥–æ—Å—Ç—É–ø** - –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ n8n

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã

### –õ–∏—Å—Ç "Exclusions"

| –ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª—É–±–∞ | –¢–∏–ø | –ì–æ—Ä–æ–¥ | –¢–∏–ø –∏—Å–∫–ª—é—á–µ–Ω–∏—è | –ü—Ä–∏—á–∏–Ω–∞ | –î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ | –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã | –î–æ–±–∞–≤–∏–ª | –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|----------------|-----|-------|----------------|---------|--------------|-------------------|---------|-----------------|------------|
| Colizeum | –°–µ—Ç—å | –í—Å–µ | –ü–æ–ª–Ω–æ–µ | –ü—Ä—è–º–æ–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å –ì–û | 31.12.2099 | - | –ò–≤–∞–Ω –ü. | 01.12.2024 | sales@darkproject.com |
| CyberX | –°–µ—Ç—å | –í—Å–µ | –ü–æ–ª–Ω–æ–µ | –†–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ –¥–∏—Å—Ç—Ä–∏–±—å—é—Ç–æ—Ä–∞ | 31.12.2099 | - | –ú–∞—Ä–∏—è –ö. | 15.11.2024 | –û–û–û "–¢–µ—Ö–Ω–æ–ì–µ–π–º" |
| Phoenix Club | –û–¥–∏–Ω | –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ | –í—Ä–µ–º–µ–Ω–Ω–æ–µ | –ò–¥—É—Ç –ø–µ—Ä–µ–≥–æ–≤–æ—Ä—ã | 01.02.2025 | –í—Å–µ | –ê–ª–µ–∫—Å–∞–Ω–¥—Ä | 09.01.2025 | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å |

### –õ–∏—Å—Ç "Patterns" (—à–∞–±–ª–æ–Ω—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π)

| –®–∞–±–ª–æ–Ω | –¢–∏–ø | –î–µ–π—Å—Ç–≤–∏–µ | –ü—Ä–∏—á–∏–Ω–∞ | –î–æ–±–∞–≤–∏–ª |
|--------|-----|----------|---------|---------|
| *@bloody.com | Email | –ò—Å–∫–ª—é—á–∏—Ç—å | –î–æ–º–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ | –°–∏—Å—Ç–µ–º–∞ |
| Bloody* | –ù–∞–∑–≤–∞–Ω–∏–µ | –ò—Å–∫–ª—é—á–∏—Ç—å | –ë—Ä–µ–Ω–¥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ | –ò–≤–∞–Ω –ü. |
| *—Ç–µ—Å—Ç* | –ù–∞–∑–≤–∞–Ω–∏–µ | –ò—Å–∫–ª—é—á–∏—Ç—å | –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ | –°–∏—Å—Ç–µ–º–∞ |

### –õ–∏—Å—Ç "Log" (–∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π)

| –î–∞—Ç–∞ | –î–µ–π—Å—Ç–≤–∏–µ | –ö–ª—É–± | –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å | –ü—Ä–∏—á–∏–Ω–∞ |
|------|----------|------|-------------|---------|
| 09.01.2025 | –î–æ–±–∞–≤–ª–µ–Ω–æ | Phoenix Club | –ê–ª–µ–∫—Å–∞–Ω–¥—Ä | –í—Ä–µ–º–µ–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ |
| 08.01.2025 | –û–±–Ω–æ–≤–ª–µ–Ω–æ | GameStation | –ú–∞—Ä–∏—è –ö. | –ü—Ä–æ–¥–ª–µ–Ω –∫–æ–Ω—Ç—Ä–∞–∫—Ç |

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ n8n

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Google Sheets

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É: [Google Sheets](https://sheets.new)
2. –ù–∞–∑–æ–≤–∏—Ç–µ –µ—ë: "Dark Project - –°–ø–∏—Å–æ–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π"
3. –°–æ–∑–¥–∞–π—Ç–µ 3 –ª–∏—Å—Ç–∞ –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞

1. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
   - –í–∞—à email (—Ä–µ–¥–∞–∫—Ç–æ—Ä)
   - Email –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (—Ä–µ–¥–∞–∫—Ç–æ—Ä)
   - Service account n8n (—Ä–µ–¥–∞–∫—Ç–æ—Ä)
3. –ü–æ–ª—É—á–∏—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –∏–∑ URL

### 3. Credentials –≤ n8n

1. –í n8n —Å–æ–∑–¥–∞–π—Ç–µ credentials "Google Sheets OAuth2"
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Service Account (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã

### 4. Workflow –¥–ª—è —á—Ç–µ–Ω–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π

```json
{
  "nodes": [
    {
      "name": "Schedule",
      "type": "n8n-nodes-base.cron",
      "parameters": {
        "triggerTimes": {
          "item": [{
            "mode": "everyHour"
          }]
        }
      }
    },
    {
      "name": "Read Exclusions",
      "type": "n8n-nodes-base.googleSheets",
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "read",
        "sheetId": "YOUR_SHEET_ID",
        "range": "Exclusions!A:J",
        "options": {
          "returnAllMatches": true
        }
      }
    },
    {
      "name": "Read Patterns", 
      "type": "n8n-nodes-base.googleSheets",
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "read",
        "sheetId": "YOUR_SHEET_ID",
        "range": "Patterns!A:E"
      }
    },
    {
      "name": "Update Redis Cache",
      "type": "n8n-nodes-base.redis",
      "parameters": {
        "operation": "set",
        "key": "exclusions:list",
        "value": "={{ JSON.stringify($json) }}",
        "expire": true,
        "ttl": 3600
      }
    }
  ]
}
```

## üìù –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö workflow

### WF-01: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
```javascript
// –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ Redis (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å)
const getExclusions = async () => {
  const cached = await redis.get('exclusions:list');
  if (cached) {
    return JSON.parse(cached);
  }
  
  // Fallback: —á–∏—Ç–∞–µ–º –Ω–∞–ø—Ä—è–º—É—é –∏–∑ Google Sheets
  const sheet = await googleSheets.read({
    sheetId: 'YOUR_SHEET_ID',
    range: 'Exclusions!A:J'
  });
  
  return sheet;
};

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—É–±–∞
const isExcluded = (clubName, city) => {
  const exclusions = await getExclusions();
  
  return exclusions.some(row => {
    const [name, type, excCity, exclType] = row;
    
    // –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
    if (name.toLowerCase() === clubName.toLowerCase()) {
      if (excCity === '–í—Å–µ' || excCity === city) {
        return exclType === '–ü–æ–ª–Ω–æ–µ' || exclType === '–í—Ä–µ–º–µ–Ω–Ω–æ–µ';
      }
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —à–∞–±–ª–æ–Ω—É
    if (name.includes('*')) {
      const pattern = name.replace('*', '.*');
      return new RegExp(pattern, 'i').test(clubName);
    }
    
    return false;
  });
};
```

### WF-04: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
```javascript
// –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è - –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –ª–æ–≥
const logExclusion = async (club, reason) => {
  await googleSheets.append({
    sheetId: 'YOUR_SHEET_ID',
    range: 'Log!A:E',
    values: [[
      new Date().toISOString(),
      '–ê–≤—Ç–æ–∏—Å–∫–ª—é—á–µ–Ω–∏–µ',
      club.name,
      '–°–∏—Å—Ç–µ–º–∞',
      reason
    ]]
  });
};
```

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### Google Apps Script –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```javascript
// –î–æ–±–∞–≤—å—Ç–µ –≤ Tools ‚Üí Script editor
function onEdit(e) {
  const sheet = e.source.getActiveSheet();
  
  if (sheet.getName() === 'Exclusions') {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
    const newExclusion = sheet.getRange(e.range.getRow(), 1, 1, 10).getValues()[0];
    
    UrlFetchApp.fetch('https://your-n8n.com/webhook/exclusion-added', {
      method: 'post',
      headers: {'Content-Type': 'application/json'},
      payload: JSON.stringify({
        club: newExclusion[0],
        type: newExclusion[3],
        addedBy: newExclusion[7],
        reason: newExclusion[4]
      })
    });
  }
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫–∞—é—â–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
function checkExpiringExclusions() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Exclusions');
  const data = sheet.getDataRange().getValues();
  const today = new Date();
  const weekFromNow = new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000);
  
  data.forEach((row, index) => {
    if (index === 0) return; // Skip header
    
    const expiryDate = new Date(row[5]);
    if (expiryDate > today && expiryDate <= weekFromNow) {
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ
      MailApp.sendEmail({
        to: 'manager@darkproject.com',
        subject: `–ò—Å—Ç–µ–∫–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ: ${row[0]}`,
        body: `–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è ${row[0]} –∏—Å—Ç–µ–∫–∞–µ—Ç ${row[5]}. –ü—Ä–∏—á–∏–Ω–∞: ${row[4]}`
      });
    }
  });
}
```

## üé® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è - –∂–µ–ª—Ç—ã–π —Ñ–æ–Ω
2. –ü–æ–ª–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è - –∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω  
3. –ò—Å—Ç–µ–∫–∞—é—â–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ - –æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω
4. –ò—Å—Ç–µ–∫—à–∏–µ - —Å–µ—Ä—ã–π —Ñ–æ–Ω

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
1. –¢–∏–ø –∏—Å–∫–ª—é—á–µ–Ω–∏—è - –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫: –ü–æ–ª–Ω–æ–µ, –í—Ä–µ–º–µ–Ω–Ω–æ–µ, –ß–∞—Å—Ç–∏—á–Ω–æ–µ
2. –î–∞—Ç–∞ - –∫–∞–ª–µ–Ω–¥–∞—Ä—å
3. –¢–∏–ø –∫–ª—É–±–∞ - –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫: –û–¥–∏–Ω, –°–µ—Ç—å

## üìä –î–∞—à–±–æ—Ä–¥ –≤ Google Sheets

–°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏:
- –í—Å–µ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–π: `=COUNTA(Exclusions!A:A)-1`
- –ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: `=COUNTIF(Exclusions!D:D,"–ü–æ–ª–Ω–æ–µ")`
- –í—Ä–µ–º–µ–Ω–Ω—ã—Ö: `=COUNTIF(Exclusions!D:D,"–í—Ä–µ–º–µ–Ω–Ω–æ–µ")`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∑–∞ –º–µ—Å—è—Ü: `=COUNTIFS(Exclusions!I:I,">="&TODAY()-30)`

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

1. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –≤—Å–µ –≤–∏–¥—è—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫
2. **–ö–æ–Ω—Ç—Ä–æ–ª—å** - –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è
4. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Service Account –¥–ª—è n8n
2. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –ø—Ä–∞–≤–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω—É–∂–Ω—ã–µ –ª–∏—Å—Ç—ã
3. –í–∫–ª—é—á–∏—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
4. –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–¢–µ–ø–µ—Ä—å –ø–æ—Å—Ç–∞–≤—â–∏–∫ –º–æ–∂–µ—Ç —Å–∞–º —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏, –∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Ö –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç!