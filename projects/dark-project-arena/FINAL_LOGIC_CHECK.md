# –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ Dark Project Arena

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ –∞–≥–µ–Ω—Ç–∞ (WF-04)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≥–µ–Ω—Ç–∞:
- **prompt**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π
  - –î–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞: `"–ù–∞—á–Ω–∏ –¥–∏–∞–ª–æ–≥ —Å –Ω–æ–≤—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º [name] –∏–∑ [city]. –£ –Ω–∏—Ö [PCs] –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π –º—è–≥–∫–∏–π –ø–æ–¥—Ö–æ–¥."`
  - –î–ª—è –æ—Ç–≤–µ—Ç–æ–≤: `$json.currentMessage` (—Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞)
- **systemMessage**: –ü–æ–ª–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å –ª–∏—á–Ω–æ—Å—Ç—å—é, –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–µ–π SPIN, –ø—Ä–∏–º–µ—Ä–∞–º–∏
- **agentType**: conversationalAgent

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
- –ü—Ä–æ–º–ø—Ç –Ω–∞ –º–µ—Å—Ç–µ
- –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω—ã—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

## ‚úÖ –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞

1. **Cron —Ç—Ä–∏–≥–≥–µ—Ä** (–∫–∞–∂–¥—ã–µ 30 –º–∏–Ω, 9:00-18:00)
2. **Get New Leads from CRM**:
   - –§–∏–ª—å—Ç—Ä: STATUS_ID = "NEW", CONTACT_COUNT = 0
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (DESC), –ø–æ –∫–æ–ª-–≤—É –ü–ö (DESC)
3. **Split & Rate Limit**: –ø–æ 1 –ª–∏–¥—É, –∑–∞–¥–µ—Ä–∂–∫–∞ 2 —Å–µ–∫
4. **Prepare Initial Contact Context**:
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `needsInitialContact = true`
   - –ü–µ—Ä–µ–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–ª—É–±–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ, –≥–æ—Ä–æ–¥, –ü–ö)
5. **Sales Agent**: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
6. **Send via channel**: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ –¥–æ—Å—Ç—É–ø–Ω—ã–π –∫–∞–Ω–∞–ª

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

## ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤

1. **Webhook —Ç—Ä–∏–≥–≥–µ—Ä—ã** (MTProto, Bitrix24)
2. **Identify Message Source**: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫
3. **Search/Load Lead**: –Ω–∞—Ö–æ–¥–∏—Ç –ª–∏–¥ –≤ CRM
4. **Prepare Agent Context**: –≥–æ—Ç–æ–≤–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –∏—Å—Ç–æ—Ä–∏–µ–π
5. **Sales Agent**: –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –æ—Ç–≤–µ—á–∞–µ—Ç
6. **Parse Response**: –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ
7. **Update CRM**: –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏ —Å—Ç–∞—Ç—É—Å
8. **Send Message**: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

## ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ –≥–æ—Ä—è—á–∏—Ö –ª–∏–¥–æ–≤ (WF-04 ‚Üí WF-05)

1. Agent –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ "HOT"
2. **Check if Hot Lead**: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
3. **Trigger Hot Lead Handoff**: –∑–∞–ø—É—Å–∫–∞–µ—Ç WF-05
4. WF-05:
   - –£–≤–µ–¥–æ–º–ª—è–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –≤ Telegram
   - –°–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É –≤ Bitrix24
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—É –∫–æ–Ω—Ç–∞–∫—Ç—ã –º–µ–Ω–µ–¥–∂–µ—Ä–∞

### –°—Ç–∞—Ç—É—Å: ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

## ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–æ –ø–æ—Å—Ç–ø—Ä–æ–¥–∞–∂–∏

### 1. –ü–∞—Ä—Å–∏–Ω–≥ –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ (WF-00 ‚Üí WF-01 ‚Üí WF-02 ‚Üí WF-03)
- **WF-00**: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –≥–æ—Ä–æ–¥–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
- **WF-01**: –ü–∞—Ä—Å–∏—Ç –∫–ª—É–±—ã –∏–∑ 2GIS
- **WF-02**: –û–±–æ–≥–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (—Å–æ—Ü—Å–µ—Ç–∏, –∫–æ–Ω—Ç–∞–∫—Ç—ã, —Ä–∞–∑–º–µ—Ä)
- **WF-03**: –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤ Bitrix24 —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º NEW

### 2. –ü—Ä–æ–≥—Ä–µ–≤ (WF-04)
- –ë–µ—Ä–µ—Ç NEW –ª–∏–¥—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
- AI Agent –≤–µ–¥–µ—Ç –¥–∏–∞–ª–æ–≥–∏
- –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã:
  - NEW ‚Üí IN_PROGRESS (–µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å)
  - IN_PROGRESS ‚Üí HOT (–≥–æ—Ç–æ–≤ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å—Å—è)
  - ‚Üí JUNK (–æ—Ç–∫–∞–∑)

### 3. –ü–µ—Ä–µ–¥–∞—á–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—É (WF-05)
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ HOT
- –£–≤–µ–¥–æ–º–ª—è–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É
- –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ —Ä—É—á–Ω–æ–π —Ä–µ–∂–∏–º

### 4. –ü–æ—Å—Ç–ø—Ä–æ–¥–∞–∂–∞ (WF-06)
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ WON
- –ß–µ—Ä–µ–∑ 30 –¥–Ω–µ–π: –∑–∞–ø—Ä–æ—Å —Ñ–∏–¥–±–µ–∫–∞
- –ß–µ—Ä–µ–∑ 90 –¥–Ω–µ–π: –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ø—Ä–æ–¥–∞–∂
- –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ç–µ–ø–ª–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞

### –°—Ç–∞—Ç—É—Å: ‚úÖ –í–°–Ø –¶–ï–ü–û–ß–ö–ê –†–ê–ë–û–¢–ê–ï–¢

## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è**: ‚úÖ
   - –ì–æ—Ä–æ–¥–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (–≤—ã—Å–æ–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π/–Ω–∏–∑–∫–∏–π)
   - –õ–∏–¥—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –∏ —Ä–∞–∑–º–µ—Ä—É –∫–ª—É–±–∞

2. **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è**: ‚úÖ
   - –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª—É–±–∞, –≥–æ—Ä–æ–¥, —Ä–∞–∑–º–µ—Ä
   - –†–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–ª—É–±–æ–≤

3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: ‚úÖ
   - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –±–µ–∑ —É—á–∞—Å—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –¥–æ –≥–æ—Ä—è—á–µ–≥–æ –ª–∏–¥–∞
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: ‚úÖ
   - Rate limiting (2 —Å–µ–∫ –º–µ–∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏)
   - Batch processing (10 –≥–æ—Ä–æ–¥–æ–≤ –∑–∞ —Ä–∞–∑)
   - –†–∞–±–æ—á–∏–µ —á–∞—Å—ã (9:00-18:00)

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∏ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ CRM —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ AI Agent —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º
- ‚úÖ –ü–µ—Ä–≤–∏—á–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ –≥–æ—Ä—è—á–∏—Ö –ª–∏–¥–æ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º
- ‚úÖ –ü–æ—Å—Ç–ø—Ä–æ–¥–∞–∂–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:
- [ ] API –∫–ª—é—á–∏ (OpenAI, Bitrix24, 2GIS, etc)
- [ ] MTProto –¥–ª—è Telegram
- [ ] WhatsApp Business API
- [ ] Qdrant —Å –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π
- [ ] Google Sheets —Å –≥–æ—Ä–æ–¥–∞–º–∏
- [ ] Webhook URLs –≤ Bitrix24

## –í—ã–≤–æ–¥: –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –†–ê–ë–û–¢–ï! üéâ